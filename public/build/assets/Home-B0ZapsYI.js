const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Map-Bk-TQfp4.js","assets/app-dJ-l6uKM.js","assets/app-l4988D9n.css","assets/Map-CS5X6EfR.css"])))=>i.map(i=>d[i]);
import{r as s,j as e,u as C,_ as T}from"./app-dJ-l6uKM.js";import{P as N}from"./PublicLayout-Bf5ehy9z.js";import"./ResponsiveNavLink-C_vEzOJa.js";import I from"./LocationCombobox-B2w0MIeg.js";import k from"./SelectFishMobile-Bd3h3sFP.js";import U from"./SelectFishDesktop-B0DYlQD2.js";import A from"./FishingRestrictions-CxYsEU3P.js";import{P as H}from"./PublicNav-B5V8Xh3Q.js";import{L as P}from"./LoadingSpinner-C0Dpt_g0.js";import"./transition-BY2wdGg2.js";import"./index-DNZ7_wiL.js";import"./getFishImageSrc-bMjek-YH.js";import"./FishRestrictionsTable-Cjv04B2V.js";function B({title:o,titleId:a,...r},i){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":a},r),o?s.createElement("title",{id:a},o):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 15 3 9m0 0 6-6M3 9h12a6 6 0 0 1 0 12h-3"}))}const D=s.forwardRef(B);function f(o){const a={loading:!1,error:null,data:null},r=(l,t)=>{switch(t.type){case"FETCH_START":return{...l,loading:!0,error:null};case"FETCH_SUCCESS":return{...l,loading:!1,data:t.payload};case"FETCH_FAILURE":return{...l,loading:!1,error:t.payload};default:return l}},[i,c]=s.useReducer(r,a);return{state:i,get:async l=>{c({type:"FETCH_START"});try{const t={nocache:o?Date.parse(o):null},h=await axios.get(l,{params:t});return c({type:"FETCH_SUCCESS",payload:h.data}),h}catch(t){return c({type:"FETCH_FAILURE",payload:t.message}),t}}}}function M({selectedLocation:o,onClick:a}){const r=s.useRef(null);return s.useEffect(()=>{r.current&&r.current.focus()},[r]),e.jsxs("button",{ref:r,"aria-label":"Back to search",onClick:a,className:"SelectedLocationButton",children:[e.jsx("strong",{children:o.fullName}),e.jsx(D,{})]})}function O({apiLastModified:o,selectedLocation:a,selectedFish:r,selectFish:i,children:c}){const[u,l]=s.useState(null),t=C(),h=f(o);return s.useEffect(()=>{h.get("/api/fishes").then(p=>l(p.data.fishes))},[]),e.jsxs(N,{className:`SmartFishLayout ${a?"sub-heading":""}`,children:[e.jsx("header",{children:e.jsx(H,{children:e.jsxs("h1",{className:"hero",children:["Smart ",e.jsx("span",{children:"Fish"})]})})}),e.jsx("main",{children:c}),e.jsx("footer",{children:t.screenOrientation.isMobile?e.jsx(k,{fishes:u,selectedFishId:r,selectFish:i}):e.jsx(U,{fishes:u,selectedFishId:r,selectFish:i})})]})}const z=s.lazy(()=>T(()=>import("./Map-Bk-TQfp4.js"),__vite__mapDeps([0,1,2,3])));function se({apiLastModified:o}){var E,y;const[a,r]=s.useState(null),[i,c]=s.useState(null),[u,l]=s.useState(null),[t,h]=s.useState(null),[p,x]=s.useState(null),[S,g]=s.useState(!1),j=s.useRef(null),m=C();m.setLandingPage("home"),f(o);const b=f(o),F=f(o);s.useState(()=>{x(m.getUserSelectedRegion())},[]);const R=n=>{m.setUserSelectedRegion(n),x(n),g(!1)};s.useEffect(()=>{b.get("/api/locations").then(n=>r(n.data.locations))},[]),s.useEffect(()=>{const n=m.getUserSelectedFish();n&&l(n)},[]),s.useEffect(()=>{var n;if(t){c(null);let d="/api/fishByLocation/"+t.value.regionId;d+="/"+(((n=t.value)==null?void 0:n.waterId)??0),d+="/"+(u??0),F.get(d).then(_=>{c(_.data.limits)})}},[t,u]);const w=n=>{let d;u===n?d=null:d=n,m.setUserSelectedFish(d),l(d)},L=()=>{h(null),setTimeout(()=>{j.current.click()},10)},v=n=>{h(n)};return e.jsxs(O,{selectedLocation:t,selectedFish:u,selectFish:w,children:[S&&e.jsx(s.Suspense,{fallback:e.jsx("div",{className:"loading",children:e.jsx(P,{})}),children:e.jsx(z,{apiLastModified:o,locations:a,selectRegion:R,setShowMap:g})}),!S&&a!==null&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"focused-layout",children:[e.jsx("div",{className:"header",children:t&&e.jsx(M,{selectedLocation:t,onClick:L})}),e.jsxs("div",{className:"body",children:[t?e.jsx(A,{isLoading:F.state.loading,restrictions:i,regionId:(E=t==null?void 0:t.value)==null?void 0:E.regionId,waterId:(y=t==null?void 0:t.value)==null?void 0:y.waterId}):null,e.jsx(I,{className:t?"hidden":"",inputRef:j,locations:a,selectedRegion:p,selectRegion:R,onChange:v,setShowMap:g})]})]}),e.jsx("div",{className:"logo",children:e.jsx("img",{src:"/images/logo.png"})})]})]})}export{se as default};
