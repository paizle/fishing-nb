import{R as m,j as s,r as a,x as j}from"./app-Bvn6fLUK.js";import{p as f,N as S}from"./NewBrunswickMap-CP6fO0pr.js";const L=(u=300,r=10)=>{const[t,o]=m.useState(null),h=m.useRef(t);m.useEffect(()=>{h.current=t},[t]);const[d,e]=m.useState(null),v=m.useRef(d);return m.useEffect(()=>{v.current=d},[d]),{onTouchStart:c=>i=>{const l=i.touches[0];o({time:Date.now(),x:l.clientX,y:l.clientY}),e({x:l.clientX,y:l.clientY}),console.log("start")},onTouchMove:c=>i=>{const l=i.touches[0];e({x:l.clientX,y:l.clientY}),console.log("move")},onTouchEnd:c=>i=>{console.log({callback:c});const l=h.current,g=v.current;if(console.log("end"),l){const x=Date.now()-l.time,w=Math.abs(l.x-g.x),E=Math.abs(l.y-g.y);x<=u&&w<=r&&E<=r&&c(i)}o(null),e(null)}}};function b({containerRef:u=null,onTouchLocation:r}){const t=u||m.createRef(null),o=L();return m.useEffect(()=>{if(t.current){const h=t.current.querySelector("svg");Object.keys(f).forEach(d=>{const e=h.querySelector("#"+d);e.classList.add("location"),r&&(e.addEventListener("touchstart",o.onTouchStart(()=>null)),e.addEventListener("touchmove",o.onTouchMove(()=>null)),e.addEventListener("touchend",o.onTouchEnd(v=>{Object.keys(f).forEach(R=>{h.querySelector("#"+R).classList.remove("active")}),h.querySelector("#"+d).classList.add("active"),r(v,d)})))})}},[t.current]),s.jsx(S,{containerRef:t})}function T({title:u,titleId:r,...t},o){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":r},t),u?a.createElement("title",{id:r},u):null,a.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm4.28 10.28a.75.75 0 0 0 0-1.06l-3-3a.75.75 0 1 0-1.06 1.06l1.72 1.72H8.25a.75.75 0 0 0 0 1.5h5.69l-1.72 1.72a.75.75 0 1 0 1.06 1.06l3-3Z",clipRule:"evenodd"}))}const M=a.forwardRef(T);function P({title:u,titleId:r,...t},o){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":r},t),u?a.createElement("title",{id:r},u):null,a.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.72 6.97a.75.75 0 1 0-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06L12 13.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L13.06 12l1.72-1.72a.75.75 0 1 0-1.06-1.06L12 10.94l-1.72-1.72Z",clipRule:"evenodd"}))}const N=a.forwardRef(P);function q({locations:u}){const r=a.useRef(null),t=a.useRef(null),[o,h]=a.useState(null),d=a.useRef(o);a.useEffect(()=>{d.current=o},[o]);const e=u.reduce((n,c)=>(n[c.name]=c,n),{}),v=n=>{const c=f[n];return e[c]};function R(n){p(null,"")}const p=(n,c)=>{t.current.querySelectorAll(".highlighted").forEach(i=>i.classList.remove("highlighted")),c?(t.current.classList.add("selected"),t.current.querySelector(`[data-path-id=${c}]`).classList.add("highlighted"),h(c)):(t.current.classList.remove("selected"),h(null))};return s.jsx("div",{className:`MapMobile portrait ${o?"selected-location":""}`,children:s.jsxs("div",{className:"container",children:[s.jsx(b,{containerRef:r,onTouchLocation:p}),s.jsxs("div",{className:"locations",ref:t,children:[s.jsx("button",{className:"close",onClick:R,children:s.jsx(N,{})}),s.jsx("ul",{children:Object.keys(f).map(n=>{var c,i;return s.jsx("li",{"data-path-id":n,children:s.jsxs(j,{href:route("location.region",{id:v(n).id}),onClick:l=>{var g;if(!((g=e==null?void 0:e[f[n]])!=null&&g.hasData))return l.preventDefault(),!1},children:[s.jsx("h3",{children:f[n]}),s.jsxs("em",{children:[!((c=e==null?void 0:e[f[n]])!=null&&c.hasData)&&s.jsx("strong",{children:"(no data)"}),(i=e==null?void 0:e[f[n]])==null?void 0:i.description]})]})},n)})}),o&&s.jsx(j,{className:"go",href:route("location.region",{id:v(o).id}),children:e!=null&&e[f[o]].hasData?s.jsx(M,{}):null})]})]})})}export{q as default};
