import{R as v,j as s,r as a,x as p}from"./app-BxJDKBYc.js";import{p as f,N as w}from"./NewBrunswickMap-DFgCGU1O.js";const L=(u=300,l=10)=>{const[t,c]=v.useState(null),h=v.useRef(t);v.useEffect(()=>{h.current=t},[t]);const[d,e]=v.useState(null),m=v.useRef(d);return v.useEffect(()=>{m.current=d},[d]),{onTouchStart:o=>i=>{const r=i.touches[0];c({time:Date.now(),x:r.clientX,y:r.clientY}),e({x:r.clientX,y:r.clientY}),console.log("start")},onTouchMove:o=>i=>{const r=i.touches[0];e({x:r.clientX,y:r.clientY}),console.log("move")},onTouchEnd:o=>i=>{console.log({callback:o});const r=h.current,j=m.current;if(console.log("end"),r){const E=Date.now()-r.time,x=Math.abs(r.x-j.x),S=Math.abs(r.y-j.y);E<=u&&x<=l&&S<=l&&o(i)}c(null),e(null)}}};function b({containerRef:u=null,onTouchLocation:l}){const t=u||v.createRef(null),c=L();return v.useEffect(()=>{if(t.current){const h=t.current.querySelector("svg");Object.keys(f).forEach(d=>{const e=h.querySelector("#"+d);e.classList.add("location"),l&&(e.addEventListener("touchstart",c.onTouchStart(()=>null)),e.addEventListener("touchmove",c.onTouchMove(()=>null)),e.addEventListener("touchend",c.onTouchEnd(m=>{Object.keys(f).forEach(g=>{h.querySelector("#"+g).classList.remove("active")}),h.querySelector("#"+d).classList.add("active"),l(m,d)})),e.addEventListener("click",m=>{Object.keys(f).forEach(g=>{h.querySelector("#"+g).classList.remove("active")}),h.querySelector("#"+d).classList.add("active"),l(m,d)}))})}},[t.current]),s.jsx(w,{containerRef:t})}function T({title:u,titleId:l,...t},c){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":l},t),u?a.createElement("title",{id:l},u):null,a.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm4.28 10.28a.75.75 0 0 0 0-1.06l-3-3a.75.75 0 1 0-1.06 1.06l1.72 1.72H8.25a.75.75 0 0 0 0 1.5h5.69l-1.72 1.72a.75.75 0 1 0 1.06 1.06l3-3Z",clipRule:"evenodd"}))}const M=a.forwardRef(T);function P({title:u,titleId:l,...t},c){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":l},t),u?a.createElement("title",{id:l},u):null,a.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.72 6.97a.75.75 0 1 0-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06L12 13.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L13.06 12l1.72-1.72a.75.75 0 1 0-1.06-1.06L12 10.94l-1.72-1.72Z",clipRule:"evenodd"}))}const y=a.forwardRef(P);function D({locations:u}){const l=a.useRef(null),t=a.useRef(null),[c,h]=a.useState(null),d=a.useRef(c);a.useEffect(()=>{d.current=c},[c]);const e=u.reduce((n,o)=>(n[o.name]=o,n),{}),m=n=>{const o=f[n];return e[o]};function g(n){R(null,"")}const R=(n,o)=>{t.current.querySelectorAll(".highlighted").forEach(i=>i.classList.remove("highlighted")),o?(t.current.classList.add("selected"),t.current.querySelector(`[data-path-id=${o}]`).classList.add("highlighted"),h(o)):(t.current.classList.remove("selected"),h(null))};return s.jsx("div",{className:`MapMobile portrait ${c?"selected-location":""}`,children:s.jsxs("div",{className:"container",children:[s.jsx(b,{containerRef:l,onTouchLocation:R}),s.jsxs("div",{className:"locations",ref:t,children:[s.jsx("button",{className:"close",onClick:g,children:s.jsx(y,{})}),s.jsx("ul",{children:Object.keys(f).map(n=>{var o,i;return s.jsx("li",{"data-path-id":n,children:s.jsxs(p,{href:route("location.region",{id:m(n).id}),onClick:r=>{var j;if(!((j=e==null?void 0:e[f[n]])!=null&&j.hasData))return r.preventDefault(),!1},children:[s.jsx("h3",{children:f[n]}),s.jsxs("em",{children:[!((o=e==null?void 0:e[f[n]])!=null&&o.hasData)&&s.jsx("strong",{children:"(no data)"}),(i=e==null?void 0:e[f[n]])==null?void 0:i.description]})]})},n)})}),c&&s.jsx(p,{className:"go",href:route("location.region",{id:m(c).id}),children:e!=null&&e[f[c]].hasData?s.jsx(M,{}):null})]})]})})}export{D as default};
