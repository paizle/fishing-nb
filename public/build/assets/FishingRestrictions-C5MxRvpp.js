import{j as a,c as h}from"./app-CmCeuH0m.js";import{P as d}from"./index-Ii1ONB9T.js";import{p,c as m}from"./parseMySqlDate-BUpSl06p.js";import{g}from"./getFishImageSrc-bMjek-YH.js";import f from"./FishRestrictionsTable-BZFLz0OZ.js";import"./format-wWbDcfoj.js";import"./Tooltip-CBiTN6xg.js";class c{constructor(t){Object.assign(this,c.convertToFishingRestriction(t))}static convertToFishingRestriction(t){var e;return{id:t.id,seasonStart:p(t.season_start),seasonEnd:p(t.season_end),bagLimit:t.bag_limit,hookLimit:t.hook_release_limit,minSize:t.minimum_size,maxSize:t.maximum_size,water:((e=t==null?void 0:t.water)==null?void 0:e.name)??"",fishingMethod:(t==null?void 0:t.method)||"",tidal:(t==null?void 0:t.tidal)||"",watersCategory:(t==null?void 0:t.water_type)||"",boundary:(t==null?void 0:t.boundary)||"",waterDescription:t.water_description??"",note:t.note}}static sortBySeasonAndGenerality(t){return t.sort((e,s)=>{let i=null;return!i&&e.fishingMethod&&(i=e.fishingMethod.localeCompare(s.fishingMethod)),i||(i=m(e.seasonStart,s.seasonStart)),!i&&e.boundary&&(i=s.boundary.localeCompare(e.boundary)),i||(e.water||e.fishingMethod||e.tidal||e.waterDescription?1:m(s.seasonEnd,e.seasonEnd))})}static formatFishingMethod(t){var s,i;let e="";return((s=t==null?void 0:t.fishing_method)==null?void 0:s.name)==="May only be angled by artificial fly or baited barbless hook with a single point"?e="Fly Fishing":e=((i=t==null?void 0:t.fishing_method)==null?void 0:i.name)??"",e}static setupGroups(t,e){Object.keys(t).forEach(s=>{const i={};let n=0;for(;n<t[s].restrictions.length;){const l=t[s].restrictions[n],r=e.map(u=>l[u]).join("-");i[r]?(i[r].group||(i[r].group=[]),i[r].group.push(l),t[s].restrictions.splice(n,1)):(i[r]=l,n++)}})}static sortRestrictions(t){Object.keys(t).forEach(e=>{t[e].restrictions=c.sortBySeasonAndGenerality(t[e].restrictions)})}}function y(o){if(!(o!=null&&o.length))return;const t=o.reduce((e,s)=>{var n;const i=((n=s==null?void 0:s.fish)==null?void 0:n.name)??null;return e[i]||(e[i]={restrictions:[]}),e[i].restrictions.push(c.convertToFishingRestriction(s)),e},{});return c.sortRestrictions(t),c.setupGroups(t,["note","fishingMethod","tidal","waterDescription","water","boundary","watersCategory"]),t}function b({className:o=""}){return a.jsxs("svg",{className:`LoadingSpinner -ml-1 mr-3 h-5 w-5 animate-spin ${o}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}function x({isLoading:o,restrictions:t,locationId:e,waterId:s}){const i=h(),n=y(t),l=()=>o?a.jsx("div",{className:"loading",children:a.jsx(b,{})}):t?t.length===0?a.jsx("div",{className:"no-results",children:"(no results)"}):Object.keys(n??{}).map(r=>a.jsx(f,{fishName:r,fishImageSrc:g(r),restrictions:n[r].restrictions,isMobile:i.screenOrientation.isMobile},r)):null;return a.jsx("div",{className:"FishingRestrictions",children:l()})}x.propTypes={isLoading:d.bool,restrictions:d.arrayOf(d.object),regionId:d.number.isRequired,waterId:d.number};export{x as default};
