import{j as a,r as u,c as f}from"./app-DN3OowiO.js";import{P as p}from"./index-VuWwlP3F.js";import{p as h,c as g}from"./parseMySqlDate-BUpSl06p.js";import{g as y}from"./getFishImageSrc-bMjek-YH.js";import b from"./FishRestrictionsTable-ku4e1Wnm.js";import"./format-wWbDcfoj.js";import"./Tooltip-DrVR7K0N.js";class l{constructor(t){Object.assign(this,l.convertToFishingRestriction(t))}static convertToFishingRestriction(t){var e;return{id:t.id,seasonStart:h(t.season_start),seasonEnd:h(t.season_end),bagLimit:t.bag_limit,hookLimit:t.hook_release_limit,minSize:t.minimum_size,maxSize:t.maximum_size,water:((e=t==null?void 0:t.water)==null?void 0:e.name)??"",fishingMethod:(t==null?void 0:t.method)||"",tidal:(t==null?void 0:t.tidal)||"",watersCategory:(t==null?void 0:t.water_type)||"",boundary:(t==null?void 0:t.boundary)||"",waterDescription:t.water_description??"",note:t.note}}static sortBySeasonAndGenerality(t){return t.sort((e,s)=>{let i=null;return!i&&e.fishingMethod&&(i=e.fishingMethod.localeCompare(s.fishingMethod)),i||(i=g(e.seasonStart,s.seasonStart)),!i&&e.boundary&&(i=s.boundary.localeCompare(e.boundary)),i||(e.water||e.fishingMethod||e.tidal||e.waterDescription?1:g(s.seasonEnd,e.seasonEnd))})}static formatFishingMethod(t){var s,i;let e="";return((s=t==null?void 0:t.fishing_method)==null?void 0:s.name)==="May only be angled by artificial fly or baited barbless hook with a single point"?e="Fly Fishing":e=((i=t==null?void 0:t.fishing_method)==null?void 0:i.name)??"",e}static setupGroups(t,e){Object.keys(t).forEach(s=>{const i={};let n=0;for(;n<t[s].restrictions.length;){const d=t[s].restrictions[n],o=e.map(m=>d[m]).join("-");i[o]?(i[o].group||(i[o].group=[]),i[o].group.push(d),t[s].restrictions.splice(n,1)):(i[o]=d,n++)}})}static sortRestrictions(t){Object.keys(t).forEach(e=>{t[e].restrictions=l.sortBySeasonAndGenerality(t[e].restrictions)})}}function x(r){if(!(r!=null&&r.length))return;const t=r.reduce((e,s)=>{var n;const i=((n=s==null?void 0:s.fish)==null?void 0:n.name)??null;return e[i]||(e[i]={restrictions:[]}),e[i].restrictions.push(l.convertToFishingRestriction(s)),e},{});return l.sortRestrictions(t),l.setupGroups(t,["note","fishingMethod","tidal","waterDescription","water","boundary","watersCategory"]),t}function j({className:r=""}){return a.jsxs("svg",{className:`LoadingSpinner -ml-1 mr-3 h-5 w-5 animate-spin ${r}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}function F({isLoading:r,restrictions:t,locationId:e,waterId:s}){const[i,n]=u.useState([]),d=f(),o=x(t);u.useEffect(()=>{let c=[];e===6&&c.push("boundary"),n(c)},[e,s]);const m=()=>r?a.jsx("div",{className:"loading",children:a.jsx(j,{})}):t?t.length===0?a.jsx("div",{className:"no-results",children:"(no results)"}):Object.keys(o??{}).map(c=>a.jsx(b,{fishName:c,fishImageSrc:y(c),restrictions:o[c].restrictions,hiddenFields:i,isMobile:d.screenOrientation.isMobile},c)):null;return a.jsx("div",{className:"FishingRestrictions",children:m()})}F.propTypes={isLoading:p.bool,restrictions:p.arrayOf(p.object),regionId:p.number.isRequired,waterId:p.number};export{F as default};
