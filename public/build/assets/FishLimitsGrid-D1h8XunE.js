import{r as v,j as a}from"./app-sb7yLzEq.js";import{p as x,a as y,f as j,c as f}from"./parseMySqlDate-C6UWLuIo.js";import{u as D}from"./useScreenOrientation-RTzdrg2i.js";import{g as L}from"./getFishImageSrc-bMjek-YH.js";class h{constructor(n){Object.assign(this,h.convertToFishingRestriction(n))}static convertToFishingRestriction(n){var t,i,r,o;return{id:n.id,seasonStart:x(n.season_start),seasonEnd:x(n.season_end),bagLimit:n.bag_limit,hookLimit:n.hook_limit,minSize:n.minimum_size,maxSize:n.maximum_size,fishingMethod:h.formatFishingMethod(n),tidal:((t=n==null?void 0:n.tidal_category)==null?void 0:t.name)??"",water:((i=n==null?void 0:n.water)==null?void 0:i.name)??"",watersCategory:((r=n==null?void 0:n.waters_category)==null?void 0:r.name)??"",boundary:((o=n==null?void 0:n.boundary)==null?void 0:o.name)??"",waterDescription:n.water_description??""}}static sortBySeasonAndGenerality(n){return n.sort((t,i)=>{let r=null;return!r&&t.fishingMethod&&(r=t.fishingMethod.localeCompare(i.fishingMethod)),r||(r=y(t.seasonStart,i.seasonStart)),!r&&t.boundary&&(r=i.boundary.localeCompare(t.boundary)),r||(t.water||t.fishingMethod||t.tidal||t.waterDescription?1:y(i.seasonEnd,t.seasonEnd))})}static formatFishingMethod(n){var i,r;let t="";return((i=n==null?void 0:n.fishing_method)==null?void 0:i.name)==="May only be angled by artificial fly or baited barbless hook with a single point"?t="Fly Fishing":t=((r=n==null?void 0:n.fishing_method)==null?void 0:r.name)??"",t}static setupGroups(n,t){Object.keys(n).forEach(i=>{const r={};let o=0;for(;o<n[i].limits.length;){const l=n[i].limits[o],c=t.map(u=>l[u]).join("-");r[c]?(r[c].group||(r[c].group=[]),r[c].group.push(l),n[i].limits.splice(o,1)):(r[c]=l,o++)}})}static sortRestrictions(n){Object.keys(n).forEach(t=>{n[t].limits=h.sortBySeasonAndGenerality(n[t].limits)})}}function C(g){if(!g.length)return;const n=g.reduce((t,i)=>{var o;const r=((o=i==null?void 0:i.fish)==null?void 0:o.name)??null;return t[r]||(t[r]={limits:[]}),t[r].limits.push(h.convertToFishingRestriction(i)),t},{});return h.sortRestrictions(n),h.setupGroups(n,["fishingMethod","tidal","waterDescription","water","boundary","watersCategory"]),n}function k({limits:g,fishes:n,hiddenFields:t=[]}){const i=C(g),r=D(),o=v.useRef(null),l=(e,s=!1)=>a.jsxs(a.Fragment,{children:[a.jsxs("span",{children:[j(e.seasonStart,r.isMobile?f.displayDayMonthShortFormat:f.displayDayMonthFormat)," "]}),a.jsxs("span",{children:["-"," ",j(e.seasonEnd,r.isMobile?f.displayDayMonthShortFormat:f.displayDayMonthFormat),s?",":""]})]}),c=(e,s)=>(e?s=s.charAt(0).toLowerCase()+s.slice(1):s=s.charAt(0).toUpperCase()+s.slice(1),s),u=e=>{let s="";return e.tidal&&(s+=c(s,e.tidal),e.water||e.watersCategory||e.boundary?s+=" portions of":s+=" waters"),e.boundary&&(s+=s?" ":"",s+=c(s,e.boundary),e.watersCategory&&(s+=" of ")),!e.water&&e.watersCategory&&(s+=c(s,e.watersCategory)),e.waterDescription&&!e.water&&(s+=e.boundary),e.water&&(s+=s?" ":"",s+=e.water),e.fishingMethod&&(s=e.fishingMethod+" in "+c(s,s)),e.waterDescription&&(s+=s?" ":"",s+=e.waterDescription)," "+s},b=e=>{const s=(e==null?void 0:e.minSize)??"N/A";return e.bagLimit===0?a.jsx("span",{className:"invalid",children:s}):s},M=e=>{const s=(e==null?void 0:e.maxSize)??"N/A";return e.bagLimit===0?a.jsx("span",{className:"invalid",children:s}):s},F=e=>e.bagLimit===null?a.jsx("span",{className:"text-md leading-4",children:"âˆž"}):e.bagLimit,S=e=>(t.forEach(s=>e[s]=null),e),p=(e,s=!1,d=!1)=>(e=S(e),a.jsxs("div",{className:`limit ${s&&!e.group?"sub-group":""}`,children:[a.jsxs("div",{className:"season-exception",children:[a.jsx("strong",{className:"date-range",children:l(e,e.group||s&&!d)}),!s&&!e.group&&a.jsx("em",{className:"water-description",children:u(e)})]}),a.jsx("div",{children:F(e)}),a.jsx("div",{children:b(e)}),a.jsx("div",{children:M(e)})]})),m=(e,s=!1)=>e.map((d,N)=>d!=null&&d.group?a.jsxs(a.Fragment,{children:[p(d),m(d.group,!0),a.jsx("em",{className:"group-water-description",children:u(d)})]}):a.jsx(a.Fragment,{children:p(d,s,N===e.length-1)}));return a.jsx("div",{className:"FishLimitsGrid",ref:o,children:a.jsx("div",{className:"body",children:Object.keys(i??{}).map((e,s)=>a.jsx(a.Fragment,{children:a.jsxs("div",{className:"fish-row-container",children:[a.jsx("div",{className:`fish-name ${s%2===0?"even":"odd"}`,children:a.jsx("strong",{children:e})}),a.jsx("div",{className:`fish-image ${s%2===0?"even":"odd"}`,children:a.jsx("img",{src:L(e)})}),a.jsxs("div",{className:"header",children:[a.jsxs("div",{className:"column-header date-range",children:[!r.isMobile&&a.jsx(a.Fragment,{children:"Season/"}),"Restrictions"]}),a.jsx("div",{className:"column-header",children:"Bag Limit"}),a.jsxs("div",{className:"column-header",children:[r.isMobile?"Min.":"Minimum"," ","Size"]}),a.jsxs("div",{className:"column-header",children:[r.isMobile?"Max.":"Maximum"," ","Size"]})]}),a.jsx("div",{className:`limits ${s%2===0?"even":"odd"}`,children:m(i[e].limits)})]},e)}))})})}export{k as default};
