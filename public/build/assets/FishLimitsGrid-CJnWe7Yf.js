import{r as w,j as o}from"./app-Bvn6fLUK.js";import{p,i as l,a as x,f as j,c as u}from"./parseMySqlDate-1ZJKP2sH.js";/* empty css                */import{u as S}from"./useScreenOrientation-CpkSlnLv.js";import{g as F}from"./getFishImageSrc-bMjek-YH.js";function D(n){var a,r,s,d;return{id:n.id,seasonStart:p(n.season_start),seasonEnd:p(n.season_end),bagLimit:n.bag_limit,minSize:n.minimum_size,maxSize:n.maximum_size,fishingMethod:z(n),tidal:((a=n==null?void 0:n.tidal_category)==null?void 0:a.name)??"",water:((r=n==null?void 0:n.water)==null?void 0:r.name)??"",watersCategory:((s=n==null?void 0:n.waters_category)==null?void 0:s.name)??"",boundary:((d=n==null?void 0:n.boundary)==null?void 0:d.name)??"",waterDescription:n.water_description??""}}function z(n){var r,s;let a="";return((r=n==null?void 0:n.fishing_method)==null?void 0:r.name)==="May only be angled by artificial fly or baited barbless hook with a single point"?a="Fly Fishing":a=((s=n==null?void 0:n.fishing_method)==null?void 0:s.name)??"",a}function L(n){return n.reduce((a,r)=>{let s=0,d=!1;for(;!d&&s<a.length;)!a[s].waterDescription&&l(r.seasonStart,a[s].seasonStart)&&l(r.seasonEnd,a[s].seasonEnd)&&r.bagLimit===a[s].bagLimit&&r.minimumSize===a[s].minimumSize&&r.maximumSize===a[s].maximumSize&&(d=!0,r.fishingMethod!==a[s].fishingMethod&&(a[s].fishingMethod=""),r.tidal!==a[s].tidal&&(a[s].tidal="")),s++;return d||a.push(r),a},[])}function N(n){return n.sort((a,r)=>{const s=x(a.seasonStart,r.seasonStart);return s===0?r.fishingMethod||r.tidal||r.waterDescription?-1:x(r.seasonEnd,a.seasonEnd):s})}function E(n){if(!n.length)return;const a=n.reduce((r,s)=>{var i;const d=((i=s==null?void 0:s.fish)==null?void 0:i.name)??null;if(!r[d]){const c={limits:[]};r[d]=c}return r[d].limits.push(D(s)),r},{});return Object.keys(a).forEach(r=>{a[r].limits=L(a[r].limits),a[r].limits=N(a[r].limits);const s={};let d=0;for(;d<a[r].limits.length;){const i=a[r].limits[d],c=[i.fishingMethod,i.tidal,i.waterDescription,i.water,i.border,i.watersCategory].join("-");s[c]?(s[c].group||(s[c].group=[]),s[c].group.push(i),a[r].limits.splice(d,1)):(s[c]=i,d++)}}),a}function A({limits:n,fishes:a}){const r=E(n),s=S(),d=w.useRef(null),i=(e,t=!1)=>o.jsxs(o.Fragment,{children:[o.jsxs("span",{children:[j(e.seasonStart,s.isMobile?u.displayDayMonthShortFormat:u.displayDayMonthFormat)," "]}),o.jsxs("span",{children:["-"," ",j(e.seasonEnd,s.isMobile?u.displayDayMonthShortFormat:u.displayDayMonthFormat),t?",":""]})]}),c=e=>{let t="";return!e.water&&e.watersCategory&&(t+=e.watersCategory+": "),e.tidal&&(t+=e.tidal),e.boundary&&(t+=e.tidal?", ":"",t+=t?" ":"",t+=e.boundary),e.waterDescription&&!e.water&&(t+=e.boundary),e.water&&(t=e.water+(t?": ":" ")+t),e.fishingMethod&&(t=e.fishingMethod+" in "+t),e.waterDescription&&(t+=t?" ":"",t+=e.waterDescription)," "+t},y=e=>{const t=(e==null?void 0:e.minSize)??"N/A";return e.bagLimit===0?o.jsx("span",{className:"invalid",children:t}):t},m=e=>{const t=(e==null?void 0:e.maxSize)??"N/A";return e.bagLimit===0?o.jsx("span",{className:"invalid",children:t}):t},M=e=>e.bagLimit===null?o.jsx("span",{className:"text-md leading-4",children:"âˆž"}):e.bagLimit,g=(e,t=!1,h=!1)=>o.jsxs("div",{className:`limit ${t&&!e.group?"sub-group":""}`,children:[o.jsxs("div",{className:"season-exception",children:[o.jsx("strong",{className:"date-range",children:i(e,e.group||t&&!h)}),!t&&!e.group&&o.jsx("em",{className:"water-description",children:c(e)})]}),o.jsx("div",{children:M(e)}),o.jsx("div",{children:y(e)}),o.jsx("div",{children:m(e)})]}),f=(e,t=!1)=>e.map((h,b)=>h!=null&&h.group?o.jsxs(o.Fragment,{children:[g(h),f(h.group,!0),o.jsx("em",{className:"group-water-description",children:c(h)})]}):o.jsx(o.Fragment,{children:g(h,t,b===e.length-1)}));return o.jsxs("div",{className:"FishLimitsGrid",ref:d,children:[o.jsxs("div",{className:"header",children:[o.jsxs("div",{className:"column-header date-range",children:[!s.isMobile&&o.jsx(o.Fragment,{children:"Season/"}),"Restrictions"]}),o.jsx("div",{className:"column-header",children:"Bag Limit"}),o.jsxs("div",{className:"column-header",children:[s.isMobile?"Min.":"Minimum"," ","Size"]}),o.jsxs("div",{className:"column-header",children:[s.isMobile?"Max.":"Maximum"," ","Size"]})]}),o.jsx("div",{className:"body",children:Object.keys(r??{}).map((e,t)=>o.jsxs("div",{className:"fish-row-container",children:[o.jsx("div",{className:`fish-name ${t%2===0?"even":"odd"}`,children:o.jsx("strong",{children:e})}),o.jsx("div",{className:`fish-image ${t%2===0?"even":"odd"}`,children:o.jsx("img",{src:F(e)})}),o.jsx("div",{className:`limits ${t%2===0?"even":"odd"}`,children:f(r[e].limits)})]},e))})]})}export{A as default};
