import{r as l,j as a}from"./app-mVeZBTl1.js";import{p as h,c as m}from"./parseMySqlDate-DjqKqIUd.js";import{u as g}from"./useScreenOrientation-B8yJaPhD.js";import{g as p}from"./getFishImageSrc-bMjek-YH.js";import f from"./FishRestrictionsTable-DmnXMGHj.js";import"./format-CU-xZK7a.js";class o{constructor(t){Object.assign(this,o.convertToFishingRestriction(t))}static convertToFishingRestriction(t){var i,s,e,r;return{id:t.id,seasonStart:h(t.season_start),seasonEnd:h(t.season_end),bagLimit:t.bag_limit,hookLimit:t.hook_limit,minSize:t.minimum_size,maxSize:t.maximum_size,fishingMethod:o.formatFishingMethod(t),tidal:((i=t==null?void 0:t.tidal_category)==null?void 0:i.name)??"",water:((s=t==null?void 0:t.water)==null?void 0:s.name)??"",watersCategory:((e=t==null?void 0:t.waters_category)==null?void 0:e.name)??"",boundary:((r=t==null?void 0:t.boundary_category)==null?void 0:r.name)??"",waterDescription:t.water_description??""}}static sortBySeasonAndGenerality(t){return t.sort((i,s)=>{let e=null;return!e&&i.fishingMethod&&(e=i.fishingMethod.localeCompare(s.fishingMethod)),e||(e=m(i.seasonStart,s.seasonStart)),!e&&i.boundary&&(e=s.boundary.localeCompare(i.boundary)),e||(i.water||i.fishingMethod||i.tidal||i.waterDescription?1:m(s.seasonEnd,i.seasonEnd))})}static formatFishingMethod(t){var s,e;let i="";return((s=t==null?void 0:t.fishing_method)==null?void 0:s.name)==="May only be angled by artificial fly or baited barbless hook with a single point"?i="Fly Fishing":i=((e=t==null?void 0:t.fishing_method)==null?void 0:e.name)??"",i}static setupGroups(t,i){Object.keys(t).forEach(s=>{const e={};let r=0;for(;r<t[s].restrictions.length;){const c=t[s].restrictions[r],n=i.map(u=>c[u]).join("-");e[n]?(e[n].group||(e[n].group=[]),e[n].group.push(c),t[s].restrictions.splice(r,1)):(e[n]=c,r++)}})}static sortRestrictions(t){Object.keys(t).forEach(i=>{t[i].restrictions=o.sortBySeasonAndGenerality(t[i].restrictions)})}}function y(d){if(!d.length)return;const t=d.reduce((i,s)=>{var r;const e=((r=s==null?void 0:s.fish)==null?void 0:r.name)??null;return i[e]||(i[e]={restrictions:[]}),i[e].restrictions.push(o.convertToFishingRestriction(s)),i},{});return o.sortRestrictions(t),o.setupGroups(t,["fishingMethod","tidal","waterDescription","water","boundary","watersCategory"]),t}function R({restrictions:d,locationId:t,waterId:i}){const[s,e]=l.useState([]),r=y(d);g(),l.useEffect(()=>{let n=[];t===6&&n.push("boundary"),i&&n.push("watersCategory"),e(n)},[t,i]);const c=n=>a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fish-name",children:a.jsx("strong",{children:n})}),a.jsx("div",{className:"fish-image",children:a.jsx("img",{src:p(n)})}),a.jsx(f,{restrictions:r[n].restrictions,hiddenFields:s})]});return a.jsx("div",{className:"FishingRestrictions",children:Object.keys(r??{}).map(n=>a.jsx("div",{className:"fish-restrictions",children:c(n)},n))})}export{R as default};
