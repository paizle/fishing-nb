import{R as v,j as l,r as i,x as j}from"./app-odsY8-e7.js";import{p as f,N as S}from"./NewBrunswickMap-HA8KE3Om.js";const b=(h=300,a=10)=>{const[t,o]=v.useState(null),d=v.useRef(t);v.useEffect(()=>{d.current=t},[t]);const[u,e]=v.useState(null),m=v.useRef(u);return v.useEffect(()=>{m.current=u},[u]),{onTouchStart:n=>s=>{const r=s.touches[0];o({time:Date.now(),x:r.clientX,y:r.clientY}),e({x:r.clientX,y:r.clientY}),console.log("start")},onTouchMove:n=>s=>{const r=s.touches[0];e({x:r.clientX,y:r.clientY}),console.log("move")},onTouchEnd:n=>s=>{console.log({callback:n});const r=d.current,g=m.current;if(console.log("end"),r){const w=Date.now()-r.time,x=Math.abs(r.x-g.x),E=Math.abs(r.y-g.y);w<=h&&x<=a&&E<=a&&n(s)}o(null),e(null)}}};function L({containerRef:h=null,onTouchLocation:a}){const t=h||v.createRef(null),o=b();return v.useEffect(()=>{if(t.current){const d=t.current.querySelector("svg");Object.keys(f).forEach(u=>{const e=d.querySelector("#"+u);e.classList.add("location"),a&&(e.addEventListener("touchstart",o.onTouchStart(()=>null)),e.addEventListener("touchmove",o.onTouchMove(()=>null)),e.addEventListener("touchend",o.onTouchEnd(m=>{Object.keys(f).forEach(p=>{d.querySelector("#"+p).classList.remove("active")}),d.querySelector("#"+u).classList.add("active"),a(m,u)})))})}},[t.current]),l.jsx(S,{containerRef:t})}function T({title:h,titleId:a,...t},o){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":a},t),h?i.createElement("title",{id:a},h):null,i.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm4.28 10.28a.75.75 0 0 0 0-1.06l-3-3a.75.75 0 1 0-1.06 1.06l1.72 1.72H8.25a.75.75 0 0 0 0 1.5h5.69l-1.72 1.72a.75.75 0 1 0 1.06 1.06l3-3Z",clipRule:"evenodd"}))}const M=i.forwardRef(T);function N({title:h,titleId:a,...t},o){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":a},t),h?i.createElement("title",{id:a},h):null,i.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.72 6.97a.75.75 0 1 0-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06L12 13.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L13.06 12l1.72-1.72a.75.75 0 1 0-1.06-1.06L12 10.94l-1.72-1.72Z",clipRule:"evenodd"}))}const P=i.forwardRef(N);function D({locations:h}){const a=i.useRef(null),t=i.useRef(null),[o,d]=i.useState(null),u=i.useRef(o);i.useEffect(()=>{u.current=o},[o]);const e=h.reduce((c,n)=>(c[n.name]=n,c),{});console.log(e);const m=c=>{const n=f[c];return e[n]};function p(c){R(null,"")}const R=(c,n)=>{if((u==null?void 0:u.current)===n){const s=m(n);internalRouting.setView("location",{id:s.id,breadCrumb:{position:1,label:s.name}})}t.current.querySelectorAll(".highlighted").forEach(s=>s.classList.remove("highlighted")),n?(t.current.classList.add("selected"),t.current.querySelector(`[data-path-id=${n}]`).classList.add("highlighted"),d(n)):(t.current.classList.remove("selected"),d(null))};return l.jsx("div",{className:`MapMobile portrait ${o?"selected-location":""}`,children:l.jsxs("div",{className:"container",children:[l.jsx(L,{containerRef:a,onTouchLocation:R}),l.jsxs("div",{className:"locations",ref:t,children:[l.jsx("button",{className:"close",onClick:p,children:l.jsx(P,{})}),l.jsx("ul",{children:Object.keys(f).map(c=>{var n,s;return l.jsx("li",{"data-path-id":c,children:l.jsxs(j,{href:route("region.page",{id:m(c).id}),onClick:r=>{var g;if(!((g=e==null?void 0:e[f[c]])!=null&&g.hasData))return r.preventDefault(),!1},children:[l.jsx("h3",{children:f[c]}),l.jsxs("em",{children:[!((n=e==null?void 0:e[f[c]])!=null&&n.hasData)&&l.jsx("strong",{children:"(no data)"}),(s=e==null?void 0:e[f[c]])==null?void 0:s.description]})]})},c)})}),o&&l.jsx(j,{className:"go",href:route("region.page",{id:m(o).id}),children:e!=null&&e[f[o]].hasData?l.jsx(M,{}):null})]})]})})}export{D as default};
