import{a as i,b as d,i as u,p as c}from"./parseMySqlDate-CERvkhiN.js";function f(t){var e;return{seasonStart:c(t.season_start),seasonEnd:c(t.season_end),bagLimit:t.bag_limit,minSize:t.minimum_size,maxSize:t.maximum_size,fishingMethod:g(t),tidal:l(t),water:((e=t==null?void 0:t.water)==null?void 0:e.name)??"",waterDescription:t.water_description??""}}function g(t){var n,s;let e="";return((n=t==null?void 0:t.fishing_method)==null?void 0:n.name)==="May only be angled by artificial fly or baited barbless hook with a single point"?e="Fly Fishing":e=((s=t==null?void 0:t.fishing_method)==null?void 0:s.name)??"",e}function l(t){let e="";return t.tidal_category&&(e&&(e+=" in "),e+=t.tidal_category.name+" waters"),e}function p(t){return t.reduce((e,n)=>{let s=0,r=!1;for(;!r&&s<e.length;)!e[s].waterDescription&&i(n.seasonStart,e[s].seasonStart)&&i(n.seasonEnd,e[s].seasonEnd)&&n.bagLimit===e[s].bagLimit&&n.minimumSize===e[s].minimumSize&&n.maximumSize===e[s].maximumSize&&(r=!0,n.fishingMethod!==e[s].fishingMethod&&(e[s].fishingMethod=""),n.tidal!==e[s].tidal&&(e[s].tidal="")),s++;return r||e.push(n),e},[])}function h(t){return t.sort((e,n)=>{const s=d(e.seasonStart,n.seasonStart);return s===0?n.fishingMethod||n.tidal||n.waterDescription?-1:d(n.seasonEnd,e.seasonEnd):s})}function E(t){if(!t.length)return;const e=t.reduce((n,s)=>{var o;const r=((o=s==null?void 0:s.fish)==null?void 0:o.name)??null;if(!n[r]){const a={seasonStart:null,seasonEnd:null,limits:[]};n[r]=a}return n[r].limits.push(f(s)),n},{});return Object.keys(e).forEach(n=>{e[n].limits=p(e[n].limits),e[n].limits=h(e[n].limits),e[n].limits.forEach(o=>{o.bagLimit&&(e[n].seasonStart?u(o.seasonStart,e[n].seasonStart)&&(e[n].seasonStart=o.seasonStart):e[n].seasonStart=o.seasonStart,e[n].seasonEnd&&u(o.seasonEnd,e[n].seasonEnd)||(e[n].seasonEnd=o.seasonEnd))});const s={};let r=0;for(;r<e[n].limits.length;){const o=e[n].limits[r],a=[o.fishingMethod,o.tidal,o.waterDescription].join("-");o.waterDescription&&s[a]?(s[a].group||(s[a].group=[]),s[a].group.push(o),e[n].limits.splice(r,1)):(s[a]=o,r++)}}),e}export{E as f,p as r,h as s};
